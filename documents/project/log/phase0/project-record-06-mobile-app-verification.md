# モバイルアプリの動作確認と次のステップ

**文書番号**: RECORD-006  
**作成日**: 2025-03-23  
**作成者**: 古川和博  
**ステータス**: 確定  
**関連文書**: 
- ARCH-002 (コンテナ化モジュラーモノリスアーキテクチャ設計)
- RECORD-005 (Svelte 5とSvelteKit 2への完全移行)

## 1. 概要

本記録は、HugMeDoプロジェクトのモバイルアプリケーション（apps/mobile）の基本動作確認と、今後の開発ステップを文書化するものです。Webアプリケーションのリファクタリングが完了した後、モバイルアプリケーションの状態を確認し、次のステップを明確にしました。

## 2. モバイルアプリの現状確認

### 2.1 基本構成

- SvelteKitプロジェクトとCapacitorの初期化が完了している
- Svelte 5とSvelteKit 2が設定されている
- TailwindCSSが設定されている
- Capacitorの基本設定（capacitor.config.ts）が存在する

### 2.2 動作確認

以下の項目を確認しました：

1. **開発サーバーの起動**
   - `pnpm dev`コマンドで正常に起動
   - ポート40010（プロジェクトルールに準拠）でアクセス可能
   - 「Welcome to SvelteKit」の初期画面が表示される

2. **静的ビルド**
   - 初期状態では`adapter-static`の設定に問題があり、ビルドに失敗
   - `+layout.ts`ファイルを作成し、`export const prerender = true`を設定
   - ビルドが正常に完了し、`build`ディレクトリに静的ファイルが生成された

3. **Svelte 5対応**
   - `+layout.svelte`ファイルでSvelte 5のRunes構文（`$props()`）が使用されている
   - 基本的なSvelte 5の構文対応は完了している

## 3. 課題と対応

### 3.1 静的ビルドの問題

**問題**：
- `adapter-static`を使用したビルド時に「動的ルートが検出された」というエラーが発生

**解決策**：
- `+layout.ts`ファイルを作成し、`export const prerender = true`を設定
- これにより、すべてのルートが静的にプリレンダリングされるようになった

### 3.2 未実装の機能

- ログイン画面
- ダッシュボード
- 認証・認可機能
- モバイル固有の機能（プッシュ通知、オフライン対応など）

## 4. 次のステップ

プロジェクトロードマップと現状を考慮し、以下の順序で開発を進めることを提案します：

1. **認証・認可基盤の実装** - Web/モバイル共通で必要
   - JWT認証の実装
   - ユーザーロールに基づくアクセス制御
   - セッション管理

2. **Webアプリの機能拡充**
   - ログイン画面の機能拡充
   - ダッシュボードの機能拡充

3. **モバイルアプリの基本実装**
   - Svelte 5/SvelteKit 2の構文に準拠したコード実装
   - モバイル向けのログイン画面とダッシュボードの実装

4. **Docker Compose設定の完成**

5. **APIゲートウェイの設定**

6. **環境変数管理の整備**

7. **モニタリング・ロギング基盤の構築**

## 5. 結論

モバイルアプリケーションの基本動作確認を行い、開発環境が正常に機能していることを確認しました。静的ビルドの問題を解決し、今後の開発ステップを明確にしました。v0.0.0（基盤構築フェーズ）の完了に向けて、認証・認可基盤の実装を最優先で進めることを提案します。
